# CBC (OAK) former for BC-60R
Simple former for cbc (oak) analysis from BC-60R VET export csv tables


# Заполнитель формы Общего Анализа Крови из экспортируемых таблиц геманализатора BC-60R в шаблон документа word
Геманализатор BC-60R Vet по стандарту идёт с программным обеспечением vetXpert, устанавливаемый на рабочий компьютер. Не смотря на большой функционал программы, 
практика работы с прибором показывает, что в лабораториях результаты переписывают с него вручную. 
Один из способов решения проблемы — подключить vetXpert к системе LIS, но так как она не распространена в частных лабораториях, такое решение требует
выбор LIS с открытым исходным кодом и большую доработку системы.
Второй способ решения проблемы — пользуясь экспортом результатов из программы, создать программу, обрабатывающий его.
Данная программа выполняет именно такую задачу.


Экспорт результатов программы представлен крайне специфичной таблицей .csv, оформленной не по общепринятым стандартам, и имеет такой вид:

... "	HGB"	"	HCT"	"	MCV"	"	MCH"	"	MCHC" ... — первая строка, с названиями столбцов

... "	12.17"	"	9.43"	"	1.57"	"	0.61"... — вторая строка, с данными


В данной программе идёт обработка и очистка этих данных, создание окна программы со следующим функционалом:

1. Выбор папки сохранения заполненных результатов

1.2 Возможность открывать после сохранения папку с созданным файлом

2. Пространство для перетягивания в него необходимого для обработки файла (drag & drop), с последующим отображением информации имени файла, фамилии владельца, клички животного
3. Возможность проставления стрелочек вверх/вниз, при выходе за референсны исследуемых значений
4. Возможность изменения цвета исследуемых значений при их выходе за референсные значения
5. Поле для фамилии врача, которая будет автоматически в дальнейшем проставляться в создаваемые бланки исследований
6. Заполнение и создание файла исследований осуществляется только через нажатие кнопки "Заполнить бланк"
7. Всплывающее предупреждающее окно с информацией о выходе MCHC за верхнюю границу референсных значений (известный показатель качественности проведённого исследования)

7.2 При выходе за пределы MCHC в окне осуществляется подсчёт истинности HCT по данным HCT и HGB из таблицы.

8. В программе установлены референсные значения кошек, собак и кроликов. При необходимости можно добавить и другие виды животных

8.2 При попытке обработать иные виды животных всплывает предупреждающее окно об отсутствии референсных значений на данный вид — в референсах будут проставляться прочерки


Обработанные результаты подставляются в документ word, в котором используются переменные в формате Jinja2: {{r rbc }}, {{ rbc_ref }} и др.
Создаваемый документ имеет название по форме: "вид животного". "ID пациента" "ОКА"




## Для работы, обязательно поменяйте путь к файлу word, который находится на 26 строчке!
По стандарту там стоит "_internal/empty_oak_template.docx", это сделано потому, что компиляция невозможна в один исполняемый файл exe из-за используемых библиотек
(например CustomTkinter), и требует сторонней привязки, из-за чего создаётся папка "_internal".
После компиляции я рекомендую поместить именно в неё ваш шаблон word, чтобы его сторонние пользователи случайно не удалили, т.к. без указания папки сохранения
заполненные шаблоны сохраняются в папке с исполняемым файлом, т.е. будут лежат рядом с шаблоном, если его не помещать в другое место. Таким образом вместе с шаблоном его
могут удалить или переместить из корневой папки программы.

В данном репрозитории шаблон имеет название "empty_cbc_oak_template", вам нужно его переименовать в "empty_oak_template" для работы, или изменить название файла в коде.

### В репрозитории есть папка "excel_tests", где располагаются файлы .csv, которые вы можете использовать для проверки функционала программы
